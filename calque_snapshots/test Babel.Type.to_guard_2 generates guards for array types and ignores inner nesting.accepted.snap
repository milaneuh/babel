---
version: 1.3.1
title: test Babel.Type.to_guard/2 generates guards for array types and ignores inner nesting
---
GIVEN several array-based Babel types, including nested arrays and arrays of options:

  array_int         = Babel.Type.array(Babel.Type.int())
  array_option_int  = Babel.Type.array(Babel.Type.option(Babel.Type.int()))
  nested_array_bool = Babel.Type.array(Babel.Type.array(Babel.Type.bool()))
  var_name          = "value"

WHEN generating guard expressions for these types:

  guards = %{
    array_int:         Babel.Type.to_guard(array_int, var_name),
    array_option_int:  Babel.Type.to_guard(array_option_int, var_name),
    nested_array_bool: Babel.Type.to_guard(nested_array_bool, var_name)
  }

THEN it should generate array guards that only enforce list-ness at the boundary:

  %{array_int: "is_list(value)", array_option_int: "is_list(value)", nested_array_bool: "is_list(value)"}
